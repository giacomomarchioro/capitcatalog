
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <script src="https://cdn.jsdelivr.net/npm/@yaireo/tagify/dist/tagify.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@yaireo/tagify/dist/tagify.polyfills.min.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/@yaireo/tagify/dist/tagify.css" rel="stylesheet" type="text/css" />
  <!-- //  Tagify  -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/css/bootstrap.min.css" rel="stylesheet"
  integrity="sha384-BmbxuPwQa2lc/FVzBcNJ7UAyJxM6wuqIj61tLrc4wSX0szH/Ev+nYRRuWlolflfl" crossorigin="anonymous">
</head>
<body>
  
    <form id="nameauthority-form" action="" method="post" role="form">
      {{ form.csrf_token }}
      <div> Autore: {{form.autore_mittente}}</div>
      <div> Commentatore: {{form.commentatore}}</div>
      <div> Dedicatario: {{form.dedicatario}} </div>
      <div> Destinatario: {{form.destinatario}} </div>
      <div> Epitomatore: {{form.epitomatore}}</div>
      <div> Glossatore: {{form.glossatore}}</div>
      <div> Traduttore o adattatore: {{form.traduttore_adattatore}}</div>
      <div> Copista: {{form.compista}}</div>
      <div> Bibliografia: {{form.bibliografia}}</div>       
        <button type="submit"> Salva</button>
    </form>
<script>
window.onload = function (){
  var input = document.querySelector('input[name=autore_mittente]')
  controller = new AbortController()
  controller; // for aborting the call
  // init Tagify script on the above inputs
  tagify = new Tagify(input, {
      whitelist : [],
    
  });

  // listen to any keystrokes which modify tagify's input
  tagify.on('input', onInput)


  function onInput( e ){
    var value = e.detail.value
    tagify.whitelist = null // reset the whitelist

    // https://developer.mozilla.org/en-US/docs/Web/API/AbortController/abort
    controller && controller.abort()
    controller = new AbortController()

    // show loading animation and hide the suggestions dropdown
    tagify.loading(true).dropdown.hide()
      fetch('http://127.0.0.1:5000/cercapersona/keyvalue/?q=' + value, {signal:controller.signal})
        .then(RES => RES.json())
        .then(function(newWhitelist){
          //output = newWhitelist.map(e => ({["value"]:e.data.title,["key"]:e.key}));
          output = newWhitelist.results.map(e => ({["value"]:e.value,["key"]:e.key}));
          tagify.whitelist = output // update inwhitelist Array in-place
          tagify.loading(false).dropdown.show(value) // render the suggestions dropdown
      })
  }

  var input2 = document.querySelector('input[name=bibliografia]'),
  tagify2 = new Tagify(input2, {
      whitelist : ["A# .NET", "A# (Axiom)", "A-0 System", "A+", "A++", "ABAP", "ABC", "ABC ALGOL", "ABSET", "ABSYS", "ACC", "Accent", "Ace DASL", "ACL2", "Avicsoft", "ACT-III", "Action!", "ActionScript", "Ada", "Adenine", "Agda", "Agilent VEE", "Agora", "AIMMS", "Alef", "ALF", "ALGOL 58", "ALGOL 60", "ALGOL 68", "ALGOL W", "Alice", "Alma-0", "AmbientTalk", "Amiga E", "AMOS", "AMPL", "Apex (Salesforce.com)", "APL", "AppleScript", "Arc", "ARexx", "Argus", "AspectJ", "Assembly language", "ATS", "Ateji PX", "AutoHotkey", "Autocoder", "AutoIt", "AutoLISP / Visual LISP", "Averest", "AWK", "Axum", "Active Server Pages", "ASP.NET", "B", "Babbage", "Bash", "BASIC", "bc", "BCPL", "BeanShell", "Batch (Windows/Dos)", "Bertrand", "BETA", "Bigwig", "Bistro", "BitC", "BLISS", "Blockly", "BlooP", "Blue", "Boo", "Boomerang", "Bourne shell (including bash and ksh)", "BREW", "BPEL", "B", "C--", "C++ – ISO/IEC 14882", "C# – ISO/IEC 23270", "C/AL", "Caché ObjectScript", "C Shell", "Caml", "Cayenne", "CDuce", "Cecil", "Cesil", "Céu", "Ceylon", "CFEngine", "CFML", "Cg", "Ch", "Chapel", "Charity", "Charm", "Chef", "CHILL", "CHIP-8", "chomski", "ChucK", "CICS", "Cilk", "Citrine (programming language)", "CL (IBM)", "Claire", "Clarion", "Clean", "Clipper", "CLIPS", "CLIST", "Clojure", "CLU", "CMS-2", "COBOL – ISO/IEC 1989", "CobolScript – COBOL Scripting language", "Cobra", "CODE", "CoffeeScript", "ColdFusion", "COMAL", "Combined Programming Language (CPL)", "COMIT", "Common Intermediate Language (CIL)", "Common Lisp (also known as CL)", "COMPASS", "Component Pascal", "Constraint Handling Rules (CHR)", "COMTRAN", "Converge", "Cool", "Coq", "Coral 66", "Corn", "CorVision", "COWSEL", "CPL", "CPL", "Cryptol", "csh", "Csound", "CSP", "CUDA", "Curl", "Curry", "Cybil", "Cyclone", "Cython", "M2001", "M4", "M#", "Machine code", "MAD (Michigan Algorithm Decoder)", "MAD/I", "Magik", "Magma", "make", "Maple", "MAPPER now part of BIS", "MARK-IV now VISION:BUILDER", "Mary", "MASM Microsoft Assembly x86", "MATH-MATIC", "Mathematica", "MATLAB", "Maxima (see also Macsyma)", "Max (Max Msp – Graphical Programming Environment)", "MaxScript internal language 3D Studio Max", "Maya (MEL)", "MDL", "Mercury", "Mesa", "Metafont", "Microcode", "MicroScript", "MIIS", "Milk (programming language)", "MIMIC", "Mirah", "Miranda", "MIVA Script", "ML", "Model 204", "Modelica", "Modula", "Modula-2", "Modula-3", "Mohol", "MOO", "Mortran", "Mouse", "MPD", "Mathcad", "MSIL – deprecated name for CIL", "MSL", "MUMPS", "Mystic Programming L"],
      blacklist : ["react", "angular"]
  });
  tagify2.on('input', onInput2)

  function onInput2( e ){
  var value = e.detail.value
  tagify2.whitelist = null // reset the whitelist
  
  // https://developer.mozilla.org/en-US/docs/Web/API/AbortController/abort
  controller && controller.abort()
  controller = new AbortController()

  // show loading animation and hide the suggestions dropdown
  tagify2.loading(true).dropdown.hide()
    fetch('https://api.zotero.org/groups/3759014/items?key=z4LzVzTMxfjhRXDffFIwM4Zg&q=' + value, {signal:controller.signal})
      .then(RES => RES.json())
      .then(function(newWhitelist){
        output = newWhitelist.map(e => ({["value"]:e.data.title,["key"]:e.key}));
        tagify2.whitelist = output // update inwhitelist Array in-place
        tagify2.loading(false).dropdown.show(value) // render the suggestions dropdown
     })
}}

  // // "remove all tags" button event listener
  // document.querySelector('.tags--removeAllBtn')
  //     .addEventListener('click', tagify.removeAllTags.bind(tagify))

  // // Chainable event listeners
  // tagify.on('add', onAddTag)
  //       .on('remove', onRemoveTag)
  //       .on('invalid', onInvalidTag);

  // // tag added callback
  // function onAddTag(e){
  //     console.log(e, e.detail);
  //     console.log( tagify.DOM.originalInput.value )
  //     tagify.off('add', onAddTag) // exmaple of removing a custom Tagify event
  // }

  // // tag remvoed callback
  // function onRemoveTag(e){
  //     console.log(e, e.detail);
  // }

  // // invalid tag added callback
  // function onInvalidTag(e){
  //     console.log(e, e.detail);
  // }
  </script>
</body>
</html>